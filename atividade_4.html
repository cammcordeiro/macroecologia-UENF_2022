<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Atividade 4</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Macroecologia Marinha</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="info.html">
    <span class="fas fa-folder"></span>
     
    Info
  </a>
</li>
<li>
  <a href="aulas.html">
    <span class="fas fa-book"></span>
     
    Aulas
  </a>
</li>
<li>
  <a href="atividades.html">
    <span class="fas fa-chart-bar"></span>
     
    Atividades
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cammcordeiro/macroecologia_02-UENF_2022">
    <span class="fab fa-github"></span>
     
    GitHub Repo
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>




</div>


<style>
body {
text-align: justify}
</style>
<div id="atividade-4" class="section level1 unnumbered">
<h1 class="unnumbered">Atividade 4</h1>
<p><br></br></p>
<div id="dados-de-peixes-recifais" class="section level2" number="0.1">
<h2><span class="header-section-number">4.1</span> Dados de peixes
recifais</h2>
<p>Para a atividade 4, partiremos dos primeiros passos da atividade 1,
mas com algumas modificações na escala do mapa (global desta vez). Para
tal, bastar realizar estes primeiros passos rodando este
<code>chunck</code> de código abaixo.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(letsR)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Importanto o shapefile</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>borb <span class="ot">&lt;-</span> rgdal<span class="sc">::</span><span class="fu">readOGR</span>(<span class="at">dsn =</span> <span class="st">&quot;data/Chaetodontidae_NewWorld.shp&quot;</span>)</span></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/Users/cesarcordeiro/git/macroecologia-UENF_2022/data/Chaetodontidae_NewWorld.shp&quot;, layer: &quot;Chaetodontidae_NewWorld&quot;
## with 29 features
## It has 27 fields
## Integer64 fields read as strings:  id_no</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando raster</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>borb_maps <span class="ot">&lt;-</span> <span class="fu">lets.presab</span>(borb, <span class="at">resol =</span> <span class="dv">3</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xmn =</span> borb<span class="sc">@</span>bbox[<span class="dv">1</span>], <span class="at">xmx =</span> borb<span class="sc">@</span>bbox[<span class="dv">3</span>], <span class="co"># America range</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ymn =</span> borb<span class="sc">@</span>bbox[<span class="dv">2</span>], <span class="at">ymx =</span> borb<span class="sc">@</span>bbox[<span class="dv">4</span>], <span class="co"># America range</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cover =</span> <span class="fl">0.01</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">remove.cells =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando matrix de presença e ausência</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>borb_pa <span class="ot">&lt;-</span> borb_maps<span class="sc">$</span>Presence_and_Absence_Matrix</span></code></pre></div>
<p><br></br></p>
</div>
<div id="riqueza-de-espécies-na-américa" class="section level2"
number="0.2">
<h2><span class="header-section-number">4.2</span> Riqueza de espécies
na América</h2>
<p>A manipulação e tratamento de dados espaciais tipo .shp exigem um
profundo conhecimento sobre os dados e a forma como eles são
armazenados. Se quiserem saber mais sobre como utilizar o R para tratar
este tipo de dados, recorram a livros como Applied spatial data analysis
with R (Bivand et al. 2013) ou An introduction to R for spatial analysis
and mapping (Brunsdown &amp; Comber 2015). Felizmente, existe um pacote
chamado letsR (Vilela &amp; Villalobos 2015) que possui uma grande
variedade de ferramentas úteis para macroecólogos. Nós já instalamos e
carregamos este pacote no início da aula e podemos utilizar suas funções
para fazer mais alguns mapas. Vamos utilizar a função lets.presab para
criar um raster (i.e., arquivo tipo imagem que armazena informações em
cada um de seus pixels; digite ‘arquivo raster’ no Google para mais
detalhes) sumarizando a riqueza de espécie de peixes borboletas na
América do Sul. Neste caso, a resolução do nosso arquivo de raster será
de 3x3 graus (i.e., cada pixel ou célula tem tamanho 3 por 3 graus);
mude a resol para valores 4 ou 5 e você verá a diferença na figura
final. Já o argumento cover garante que somente pixels que tenham mais
de 1% de sua área sobre do continente sejam mantidos (mude estes valores
e veja a diferença no mapa resultante). Como nosso objetivo é um mapa da
América, as coordenadas limites foram definidas para realizar o
exercício somente ao longo da extensão desejada (argumentos xmn, xmx,
ymn e ymx da função <code>lets.presab</code>).</p>
<p><br></br></p>
</div>
<div id="padrões-geográficos-de-diversidade-filogenética"
class="section level2" number="0.3">
<h2><span class="header-section-number">4.3</span> Padrões geográficos
de diversidade filogenética</h2>
<p>Para entendermos melhor como podemos utilizar diferentes informações
em larga escala, vamos proceder com um exercício sobre diversidade
filogenética. Muito da macroecologia tem sido feito no sentido de
incorporar informações filogenéticas às análises espaciais/geográficas.
Desta forma, os padrões que analisamos em larga escala contém
informações não somente da distribuição dos organismos mas também da
evolução/história evolutiva das linhagens (vide o nome desta
disciplina). Eu não entrarei em detalhes sobre a teoria por trás destes
tipos de métricas, mas para maiores informações vejam papers recentes na
area (e.g., Ives &amp; Helmus 2010, Mouquet et al. 2012, Miller et
al. 2016 Tucker et al. 2016).</p>
<div id="base-de-dados-filogenéticos" class="section level3"
number="0.3.1">
<h3><span class="header-section-number">4.3.1</span> Base de dados
filogenéticos</h3>
<p>Para iniciar, nós precisamos encontrar uma filogenia do grupo com o
qual nós estamos trabalhando. Para aves, mamíferos, possivelmente
répteis e alguns anfíbios este tipo de informação pode ser encontrada em
algum trabalho já publicado.</p>
<p>Como estamos tratando de peixes, boa parte das espécies já está
descrita e a filogenia da maior parte delas também encontra-se
disponível. Esta filogenia usada aqui foi encontrada a partir de uma
publicacao recente (ver Leprieur et al. 2015). Primeiro tenham certeza
de que os arquivos estão na pasta onde vocês estão rodando este script e
que vocês conseguem acessá-los a partir do R. Depois, é so carregar a
árvore filogenética e proseguir com algumas manipulações simples para
visualizá-la. No meio do código abaixo, nós precisaremos criar um outro
nome para as espécies de peixes para que tanto o shape borb_maps quanto
o objeto filo contenham exatamente o mesmo nome. Se houver pequenas
diferenças (e.g., <em>“Tachyglossus aculeatus”</em> em vez de
<em>“Tachyglossus_aculeatus”</em>) as funções vão travar e você não
conseguirá computar os índices e fazer os procedimentos.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Caso não tenha install.packages(&#39;ape&#39;)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lendo arvore filogenetica</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>filo <span class="ot">&lt;-</span> <span class="fu">read.tree</span>(<span class="st">&quot;data/newChaetNode.txt&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>filo</span></code></pre></div>
<pre><code>## 
## Phylogenetic tree with 130 tips and 95 internal nodes.
## 
## Tip labels:
##   Johnrandallia_nigrirostris, Heniochus_chrysostomus, Heniochus_intermedius, Heniochus_singularius, Heniochus_monoceros, Heniochus_singularis, ...
## Node labels:
##   N1, N2, N3, N4, N5, N6, ...
## 
## Rooted; includes branch lengths.</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.phylo</span>(filo, <span class="at">type =</span> <span class="st">&quot;fan&quot;</span>, <span class="at">edge.color =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">cex =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="atividade_4_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># algumas informacoes uteis is.rooted(filo)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># is.ultrametric(filo) filo$tip.label</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mudando nome de mami de acordo com a filogenia </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># função para mudar nome</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>muda_nome <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">strsplit</span>(<span class="at">x =</span> <span class="fu">as.character</span>(x), <span class="st">&quot; &quot;</span>), <span class="cf">function</span>(x) {</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>], <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># mudando nome da matrix local vs espécie</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(borb_pa) <span class="ot">=</span> <span class="fu">muda_nome</span>(<span class="fu">colnames</span>(borb_pa))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># especies presentes tanto na filogenia quanto no arquivo</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># mami separando somente as especies em ambos os objetos</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">intersect</span>(filo<span class="sc">$</span>tip.label, <span class="fu">colnames</span>(borb_pa))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># excluindo as especies do mapa para reter somente as</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># especies presentes na filogenia</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>borb <span class="ot">&lt;-</span> borb[borb<span class="sc">$</span>binomialMod <span class="sc">%in%</span> sp, ]</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(borb)</span></code></pre></div>
<pre><code>## [1]  0 27</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># excluindo as especies da matrix para reter somente as</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># especies presentes na filogenia</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>borb_pa <span class="ot">&lt;-</span> borb_pa[, <span class="fu">colnames</span>(borb_pa) <span class="sc">%in%</span> sp]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(borb_pa)</span></code></pre></div>
<pre><code>## [1] 3360   29</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(sp)</span></code></pre></div>
<p><br></br></p>
</div>
<div id="carregando-e-limpando-a-árvores-filogenética"
class="section level3" number="0.3.2">
<h3><span class="header-section-number">4.3.2</span> Carregando e
limpando a árvores filogenética</h3>
<p>Outro ponto importante é retirar da filogenia todas as espécies que
não serão utilizadas. Isto facilitará o cálculo e manterá somente as
espécies presentes em <strong>mat</strong>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Caso não tenha install.packages(&#39;picante&#39;)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(picante)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># deixar na filo as sp da matrix</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>filo_gamb <span class="ot">&lt;-</span> <span class="fu">prune.sample</span>(<span class="at">samp =</span> borb_pa, <span class="at">phylo =</span> filo)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.phylo</span>(filo_gamb, <span class="at">type =</span> <span class="st">&quot;fan&quot;</span>, <span class="at">edge.color =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="atividade_4_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="calculando-as-métricas-filogenéticas" class="section level3"
number="0.3.3">
<h3><span class="header-section-number">4.3.3</span> Calculando as
métricas filogenéticas</h3>
<p>Existem diversas métricas filogenéticas que trazem informacoes
distintas sobre a comunidade. A mais comum e mais antiga é Diversidade
Filogenética, que nada mais é do que a soma dos ramos da àrvore
filogenética correspondentes às especies presentes na comunidade.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Faith&#39;s Phylogenetic diversity</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>PD <span class="ot">&lt;-</span> <span class="fu">pd</span>(<span class="at">samp =</span> borb_pa, <span class="at">tree =</span> filo_gamb, <span class="at">include.root =</span> T)</span></code></pre></div>
<p>Uma outra informaçao complementar é fornecida pela distancia média
dos ramos filogenéticos correspondentes às especies presentes em uma
assémbleia. Esse indice da uma ideia do quao filogeneticamente próximas
são as especies presentes em uma comunidade. Se os valores sao pequenos,
mais relacionadas filogeneticamente são as espécies; se mais distantes,
mais diferentes elas sao em termos de história evolutiva. Vamos
calculareste novo indice e juntá-lo àqueles anteriormente
calculados.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># more indices: Mean pairwise distance separating taxa in a</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># community</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>phydist <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(filo_gamb) <span class="co">#distancia fologenetica entre especies</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>mpd.result <span class="ot">&lt;-</span> <span class="fu">mpd</span>(borb_pa, phydist)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(phydist)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>PD <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(PD, mpd.result)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>PD[<span class="fu">is.na</span>(PD)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PD[<span class="fu">order</span>(PD<span class="sc">$</span>SR, <span class="at">decreasing =</span> T), ], <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##            PD SR mpd.result
## 2396 117.4201  8    35.0466
## 2397 117.4201  8    35.0466
## 2401 117.4201  8    35.0466
## 2509 117.4201  8    35.0466
## 2510 117.4201  8    35.0466
## 2516 117.4201  8    35.0466
## 2520 117.4201  8    35.0466
## 2521 117.4201  8    35.0466
## 2522 117.4201  8    35.0466
## 2637 117.4201  8    35.0466</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># relação entre todos os índices calculados</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(PD)</span></code></pre></div>
<p><img src="atividade_4_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="plotando-os-índices-no-mapa" class="section level3"
number="0.3.4">
<h3><span class="header-section-number">4.3.4</span> Plotando os índices
no mapa</h3>
<p>Agora que ja temos uma planilha contendo cada um destes indices, nos
podemos utilizar o mapa de riqueza para mapear os indices no espaço.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># criar uma cópia para evitar perder informações</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>borb2 <span class="ot">&lt;-</span> borb_maps</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matriz, raster e variaveis calculadas estao na mesma ordem</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">rowSums</span>(borb_pa), <span class="fu">values</span>(borb2<span class="sc">$</span>Richness_Raster))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">rowSums</span>(borb_pa), PD<span class="sc">$</span>SR)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(borb2, <span class="at">main =</span> <span class="st">&quot;Riqueza de especies&quot;</span>)</span></code></pre></div>
<p><img src="atividade_4_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># basta mudar os valores do raster original pela metrica</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># desejada PDiv</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>raster<span class="sc">::</span><span class="fu">values</span>(borb2<span class="sc">$</span>Richness_Raster) <span class="ot">&lt;-</span> PD<span class="sc">$</span>PD</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(borb2, <span class="at">main =</span> <span class="st">&quot;Diversidade filogenetica&quot;</span>)</span></code></pre></div>
<p><img src="atividade_4_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MPDist</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(borb2<span class="sc">$</span>Richness_Raster) <span class="ot">&lt;-</span> PD<span class="sc">$</span>mpd.result</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(borb2, <span class="at">main =</span> <span class="st">&quot;Mean Pairwise Distance&quot;</span>)</span></code></pre></div>
<p><img src="atividade_4_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Que padrões vocês enxergam? Eles são os mesmos entre os indices?
Quais são os mecanismos que explicam estes padrões? <br></br></p>
</div>
</div>
<div id="referências" class="section level2" number="0.4">
<h2><span class="header-section-number">4.4</span> Referências</h2>
<ul>
<li>Ives AR, Helmus MR (2010). Phylogenetic metrics of community
similarity. The American Naturalist, 176, E128–E142.</li>
<li>Leprieur F, Colosio S, Descombes P, Parravicini V, Kulbicki M,
Cowman PF et al. (2015) Historical and contemporary determinants of
global phylogenetic structure in tropical reef fish faunas. Ecography,
39, 825–835.</li>
<li>Miller ET, Farine DR, Trisos CH (2016) Phylogenetic community
structure metrics and null models: A review with new methods and
software. Ecography, 40, 461–477.</li>
<li>Mouquet N, Devictor V, Meynard CN, Munoz F, Bersier L-F, Chave J et
al. (2012) Ecophylogenetics: Advances and perspectives. Biological
Reviews, 87, 769–785.</li>
<li>Tucker CM, Cadotte MW, Carvalho SB, Davies TJ, Ferrier S, Fritz SA
et al. (2016) A guide to phylogenetic metrics for conservation,
community ecology and macroecology. Biological Reviews, 92,
698–715.</li>
<li>Vilela B, Villalobos F (2015) letsR: A new r package for data
handling and analysis in macroecology. Methods in Ecology and Evolution,
6, 1229–1234.</li>
</ul>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
